security {
    rate_limit 100/min per ip

    on brute_force {
        blacklist ip for 24h
        log threat(ip, "brute force detected")
        alert admin
    }

    on sql_injection {
        block request
        blacklist ip for 72h
        log threat(ip, request.raw)
        fingerprint attacker
    }

    on xss {
        block request
        blacklist ip for 48h
        log threat(ip, "xss attempt")
    }

    on ddos {
        enable shield_mode
        allow only whitelisted
        log threat(ip, "ddos pattern")
    }
}
